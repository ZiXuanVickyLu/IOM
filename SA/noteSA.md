## 模拟退火算法

### 基本思想

​	退火是指将固体加热到足够高的温度，使分子呈随机排列状态，然后逐步降温使之冷却，最后分子以低能状态排列， 固体达到某种稳定状态。

#### 物理退火的过程

- 加温过程

  增强粒子的热运动，消除系统原先可能存在的非均匀态

- 等温过程

  对于与环境换热而温度不变的封闭系统，系统状态的自发变化总是朝着自由能减少的方向进行，当自由能达到最小时候，系统达到平衡态。

- 冷却过程

  粒子热运动减弱并渐趋于有序，系统能量逐渐下降，从而得到低能的晶体结构

  

#### SA算法

​	在SA中将目标函数作为能量函数，模拟过程：初始高温，温度缓慢下降，终止在低温，能量函数达到最小

### 数学表述

​	在温度$T$，分子停留在状态$r$，满足Boltzmann概率分布

$P\{\bar{E} = E(r)\} = \frac{1}{Z(T)}\exp\left(-\frac{E(r)}{k_BT}\right)$，其中

$Z(T) = \sum_{s\in D}\exp\left(\frac{-E(s)}{k_BT}\right)$

$Z$的确定：使得$\sum P=1$



### 退火过程和Bolzman方程

温度$T_k$对$P_i(T_k)$的影响

1. 当$T_k\rightarrow\infty$时，$E_i/T_k\rightarrow0$，$P(T_K)\approx 1/n$，各个状态概率几乎相等，SA做广域搜索
2. 当$T_k\rightarrow 0$时，$E_i/T_k\rightarrow\infty$，$E_i$与$E_j$的小差别带来$P_i(T_k)$和$P_j(T_k)$的巨大差别，从而当$T_k\rightarrow 0$时，以概率$1$趋于最小能量状态

**结论：**在高温之下$S$可以处于任何能量状态，此时SA可以看成广域搜索，以免陷入局部最优；低温状态下，S只能处于能量较小的状态，此时SA可以看成是在做局部搜索，以便将解精细化。当温度趋于零时，S以概率$1$处于能量最小状态，此时的SA获得全局最优解。



### SA的主要步骤

给定初始温度$t=t_0$，随机产生初始状态$s=s_0$，令$k=0$

repeat：

​	repeat：

​	产生新状态$s_j=\text{Genete(s)}$

​	if **$\min\{1, \exp[-1(C(s_j)-C(s))/t_k]\}\ge\text{random[0,1]},\quad s=s_j$**

​	until **抽样稳定准则满足**

​	退温，$t_{k+1}=\text{update}(t_k)$，并且令$k=k+1$

until**算法终止准则满足**

输出算法搜索结果



三函数：生成函数、更新函数、温度更新函数

两准则：抽样稳定准则、算法终止准则



### SA模拟的要求

1. 初始温度足够高
2. 热平衡时间足够长
3. 降温过程足够慢
4. 终止温度足够低

满足以上的条件，则SA就可以终止在最优解，但是以上的条件很难满足，因此只能记录历史最优解